---
title: Missing/Semester
date: 2023-01-18 17:33:27
tags: missing semester
---
# lesson 1 shell
## prerequisite：在windows系统安装Linux子系统
<!-- more -->
### 环境配置
- step1 下载``wsl``
  - win11在微软应用商店下载wsl
- step2 打开 控制面板->启用或关闭windows功能->打开"适用于Linux的Windows子系统" 重启
- step3 微软应用商店下载Ubuntu
- step4 管理员身份运行powershell(?)
- step5 输入 wsl -l -v 检查每个发行版的 WSL 版本
- step6 Ubuntu初始化用户名 密码(输入时不显示)
### what is shell 
计算机有多种多样的交互接口可以进行指令的的输入，例如图像用户界面（GUI），语音输入、AR/VR ... 这些交互接口可以覆盖 80% 的使用场景，但也从根本上限制了操作方式——不能点击一个不存在的按钮或者是用语音输入一个还没有被录入的指令。 为了充分利用计算机的能力，我们回到最根本的方式——使用文字接口：Shell。shell是用户和电脑交互的最主要方式之一，属于非可视化界面。

shell 是一个编程环境，所以它具备变量、条件、循环和函数，shell 本身可以看作一门程序设计语言（既是应用程序，又是一种脚本语言），你输入的提示符不仅可以带参，也可以写出条件、循环和函数。

命令行工具和基于文本的工具可以打破可视化界面的限制，使不同的基于文本实现的各种各样的功能，以各种各样的方式耦合起来。shell即是你使用这些工具的”工作地点“。

几乎所有平台都支持某种形式的 shell，有些甚至提供了多种 shell，但核心功能都是一样的：它允许你执行程序，输入并获取某种半结构化的输出。

以下我们会使用 Bourne Again SHell, 简称 ``bash`` 。 这是被最广泛使用的一种 shell，它的语法和其他的 shell 都是类似的。打开shell 提示符（输入指令的地方），首先需要打开终端。设备通常都已经内置了终端。
## 基本命令
- ``man``
- ``history``：查看历史记录
  - ``history | more`` 分屏显示 每次只显示一页，空格键显示下一页，q键退出显示，h键可以获取帮助
- ``date``：日期
- ``clear``：清屏
### 环境变量
- ``echo``
  - 参数输入
    - echo hello //输出hello
    - echo hello world //输出hello
  - 如果传递的参数中包含空格（例如一个名为 My Photos 的文件夹）
    - 使用单引号或双引号包裹起来
    - 使用转义符号 ``\`` 进行处理``My\ Photos``。
  - ``echo $PATH``
    - 环境变量：用来指定操作系统运行环境的一些参数，如：临时文件夹位置和系统文件夹位置等，shell 通过环境变量去搜索程序
    - path环境变量的作用: 告诉系统当要求系统运行一个程序而没有告诉它程序所在的完整路径时，系统除了在当前目录下面寻找此程序外，还应到哪些目录下去寻找。而通常情况下配置的path变量，就是这个目录的完整路径。
  - which echo：
  - 查看命令所在
    - windows下把文件分在不同的盘C:/ D:/ etc，在Linux下所有文件在一个root下
- ``pwd``：print working directory,当前工作目录
### 路径
- 文件路径：绝对路径以``/``(Linux 和 macOS 上,Windows上是 ``\``)开头，其他的都是相对路径。
  - cd：change directory
  - ``.``表示当前目录,``./``切换到当前目录
  - ``..``表示上级目录,``../``切换到上层目录
  -  ``~``表示用户目录,``cd ~``切换到主目录
  -  ``-``表示最近一次到达的目录,``cd -``切换到上次进入的路径
  -  ``/``表示的是根目录,``/``切换到根目录
- ``ls``：查看指定目录下包含的文件及信息
  - ``ls -a``：显示指定目录下的所有子目录和文件（包括隐藏文件）
  - ``ls -l``：以列表的方式显示指定目录下的所有子目录和文件的详细信息
  - drwxr-xr-x的含义：
    - ``d``表示 grapefruitcat 是一个目录。接下来的九个字符，每三个构成一组，共三组，分别代表**文件所有者**(grapefruitcat)、**用户组**(users)、**其他所有人具有的权限**。在一组字符中，出现的有``rwx-``四种字符。
    - ``-``表示该用户不具备相应的权限
    - ``r``表示该用户具有读取文件的权限。为了列出路径所包含的内容，用户必须对路径下所有的文件夹具备读取权限。
    - ``w``表示该用户具有写文件的权限。只有文件所有者可以修改grapefruitcat 文件夹 (例如，添加或删除文件夹中的文件)。如果一个用户有目标文件的w权限，但没有文件所在目录下的w权限，则用户只能修改文件内的内容，但不可对整个文件进行删除等操作。    
    - ``x``表示该用户具有执行文件的权限。为了进入某个文件夹，用户需要具备该文件夹以及其父文件夹的“搜索”权限。
  - ``ls -lh``：显示文件大小
  - ``ls --help``
- ``mv`` 移动文件。移动文件或目录，也可以给文件或目录重命名(此处的重命名指的是复制一份内容相同名字不同的文件出来)
- ``cp``：拷贝文件，将给出的文件或目录复制到另一个文件或目录中
- ``rm``: 删除文件和目录
- ``rmdir``：删除一个整个文件夹。必须离开目录，且只能在目标文件夹为空文件夹时使用
- ``mkdir``：创建一个新的目录。参数-p可递归创建目录。需要注意新建目录的名称不能与当前目录中已有的目录或文件同名，且须对当前目录有写权限。

### 重定向数据流
程序的两个主要流：输入流和输出流。当程序尝试读取信息时，会从输入流中进行读取；当程序打印信息时，会将信息输出到输出流中。通常，一个程序的输入输出流都是终端。即键盘作为输入，显示器作为输出。但是也可以重定向这些流！
- ``<``file``>``file^C，最简单的重定向，即分别为input输入流和output输出流，可以将程序的输入输出流分别重定向到文件
- ``>>``向文件追加内容(默认换行，加参数``-n``不换行)。**注意``>``的功能为覆盖重写，而``>>``为追加**
- 管道符(pipes)``|``，更好的利用文件重定向。``|``操作符允许将一个程序的输出和另外一个程序的输入连接起来。前后互不影响，视作现实中的管子——管子的一头塞东西进去，另一头取出来，这里``|``的左右分为两端，左端塞东西(写)，右端取东西(读)
- ``cat``：查看文件内容
```
echo hello > hello.txt
cat < hello.txt > hello2.txt
cat hello2.txt//hello
```
### sudo 根用户权限
根用户几乎不受任何限制，可以创建、读取、更新和删除系统中的任何文件。但通常我们不会以根用户的身份直接登录系统，因为这样可能会因为某些错误的操作而破坏系统。我们会在需要的时候使用``sudo``命令。顾名思义，它的作用是让用户可以以 su(super user)的身份执行一些操作。
向``sysfs``文件写入内容是必须作为根用户才能做的。``sysfs``文件则\暴露了一些内核(kernel)参数。 Windows 和 macOS 没有这个文件。
- sudo
  - sudo rm -f 文件名：删除文件（夹）。
- rm：使用rm命令要小心，因为文件删除后不能恢复。为了防止文件误删，可以在rm后使用-i参数以逐个确认要删除的文件。
  - -r：递归删除目录
  - -i：以交互式方式执行，提示用户是否进行指定的删除操作
  - -f：强制删除，忽略不存在的文件，无需提示
- grep:文本搜索 如果找到匹配模式，grep打印包含模式的所有行。格式为：$grep [-选项] ‘搜索内容串’文件名$
  - -v：显示不包含匹配文本的所有行（相当于取反）
  - -n：显示匹配行及行号
  - -i：不区分大小写
- su:切换用户
### 其他
- xdg -open：打开文件
- ln：建立链接文件，链接文件类似于Windows下的快捷方式。链接文件分为软链接和硬链接。
  - 软链接：软链接不占用磁盘空间，源文件删除则软链接失效。ln -s 源文件 链接文件
  - 硬链接：硬链接只能链接普通文件，不能链接目录。两个文件占用相同大小的硬盘空间，即使删除了源文件，链接文件还是存在。ln 源文件 链接文件
- find：查找文件，通常用来在特定的目录下搜索符合条件的文件
- tar：归档管理
- ps：查看进程信息
- top：动态显示进程
- kill：终止进程
- ifconfig：查看网卡信息
- ping：测试远程主机连通性
- whoami：查看当前用户
- exit：如果是图形界面，退出当前终端；如果是使用ssh远程登录，退出登陆账户
- useradd：添加用户账号
- which:查看命令所在
- passwd:设置用户密码
- curl --head --silent baidu.com | grep content.length
# lesson 2 bash
# lesson 3 Editors
- vscode
## vim
### mode
- normal
  - insert 键入``i``进入插入模式
  - replace 键入``R``进入替换模式
  - visual 键入``v``进入可视(一般)模式
    - 键入``V``进入可视(行)模式
    - 键入``Ctrl V`` 进入可视(块)模式
  - command-line 键入``:``进入命令模式
    - ``:q`` 退出（关闭窗口）
    - ``:w`` 保存（写）
    - ``:wq`` 保存然后退出
    - ``:e`` {文件名} 打开要编辑的文件
    - ``:ls`` 显示打开的缓存
    - ``:help`` {标题}打开帮助文档
    - ``:help :w`` 打开 :w 命令的帮助文档
    - ``:help w`` 打开 w 移动的帮助文档
### Vim’s interface is a programming language
Vim 的界面本身是一个程序语言。键入操作 （以及他们的助记名） 本身是命令， 这些命令可以组合使用。 这使得移动和编辑更加高效。
#### movement
- 基本移动: ``hjkl ``（左， 下， 上， 右）
- 词： ``w``（下一个词）,``b``（上一个词/词初），``e``（下一个词/词尾）
- 行： ``0``（行初）， ``^``（第一个非空格字符），``$``（行尾）
- 屏幕： ``H`` （屏幕首行）， ``M``（屏幕中间）， ``L`` （屏幕底部）
- 翻页： ``Ctrl-u`` （上翻）， ``Ctrl-d`` （下翻）
- 文件： ``gg`` （文件头）， ``G`` （文件尾）
- 行数：{行数}G ({行数}为行数)
- 杂项： ``%`` （找到配对，比如括号或者 /* */ 之类的注释对）
- 查找：``f{字符}``，``t{字符}``，``F{字符}``，``T{字符}``
  - 查找/到 向前/向后 在本行的
  - ``,`` / ``;`` 用于导航匹配
- 搜索: ``/{正则表达式}``, ``n`` /``N``用于导航匹配
#### Selection
可视化模式:
- 可视化：``v``
- 可视化行： ``V``
- 可视化块：``Ctrl+v``
- 可以用移动命令来选中。

#### Edits
- ``i``进入插入模式 （insert）
  - 但是对于操纵/编辑文本，不单想用退格键完成
- ``O / o`` 在之上/之下插入行（open）
- ``d{motion}`` 删除 {motion} （delete）
  - 例如， ``dw`` 删除词, ``d$`` 删除到行尾, ``d0`` 删除到行头。
  - ``dd-``删除整行
- ``c{motion}``改变 {motion} （change）
  - 例如， cw 改变词
  - c{motion} 等同于 d{motion} 再 i进入编辑模式
- ``x`` 删除字符（等同于 dl）
- ``s`` 替换（substitute）字符（等同于 xi）
- 可视化模式 + 移动操作（上下左右等移动光标的操作）
  - 选中文字,然后使用 ``d`` 删除 或者 ``c`` 改变
- ``u`` 撤销（undo）, ``<C-r>`` 重做（redo）
- ``y`` 复制（yank）（其他一些命令比如 d 也会复制）
- ``p`` 粘贴（paste）
#### Counts
使用一个数字来结合Movement和Edits，这会执行指定操作若干次。
例如：
- ``3w`` 向前移动三个词
- ``5j`` 向下移动5行
- ``7dw`` 删除7个词
#### Modifiers
可以用修饰语改变“名词”的意义。修饰语有 i，表示“内部”或者“在内“，和 a， 表示”周围“。
- ``ci``( 改变当前括号内的内容
- ``ci``[ 改变当前方括号内的内容
- ``da'`` 删除一个单引号字符串，包括周围的单引号
## 编辑并运行c++文件
- step1 sudo apt-get update
- step2 sudo apt install g++
- step3 sudo vim hello.cpp
- step4 vim编辑
- step5 g++ hello.cpp -o hello
- step6 ./hello
# lesson 4 Data Wranling 数据整理
``journalctl | grep - i intel``，找到所有包含intel(不区分大小写)的系统日志，将某种形式的数据（全部系统日志）转换成了另外一种形式的数据（仅包含intel的日志）
## 日志处理
- ``ssh myserver journalctl``尝试过登录服务器的用户数据
- ``ssh myserver journalctl | grep sshd``，涉及sshd的信息
- ``sh myserver 'journalctl | grep sshd | grep "Disconnected from"' | less``，为节省流量，先在远端机器上过滤文本内容，然后再将结果传输到本机
  - ``less`` 创建文件分页器
- 进一步节省流量，将当前过滤出的日志保存到文件中，使后续访问该文件不需经过网络
```
$ ssh myserver 'journalctl | grep sshd | grep "Disconnected from"' > ssh.log
$ less ssh.log
```
### sed
``sed``是一个基于文本编辑器``ed``构建的”流编辑器” 。在 sed 中，基本上是利用一些简短的命令来修改文件，而不是直接操作文件的内容(尽管也可以选择这样做)。
- 语法 ``sed [-hnV][-e<script>][-f<script文件>][文本文件]``
- 参数
  - 命令行命令``s``，即替换命令：``s/REGEX/SUBSTITUTION/``
    - ``REGEX``部分是需要使用的正则表达式，
    - ``SUBSTITUTION``部分是用于替换匹配结果的文本
```
ssh myserver journalctl
 | grep sshd
 | grep "Disconnected from"
 | sed 's/.*Disconnected from //'
```
  - ``-e`` 在同一行里执行多条命令
  - ``-i`` 文本注入
  - ``-p`` 打印特定的行
- ``sort`` 对其输入数据进行排序
  - ``sort -nk1,1`` 按照数字顺序对输入进行排序(默认按照字典序排序)``-k1,1``表示仅基于以空格分割的第一列进行排序。``n``表示仅排序到第n个部分，默认到行尾
  - ``sort -r`` 倒序排列
- ``uniq -c`` 把连续出现的行折叠为一行并使用出现次数作为前缀
- ``head``
  - 作用：查看一个文件的前n行，如果不指定n，则默认显示前10行
  - 语法：head -n 文件路径（n表示数字）
- ``tail``
  - 作用1：查看一个文件的末n行，如果n不指定默认显示后10行
  - 语法1：tail -n 文件名
  - 作用2：查看一个文件的动态变化（变化的内容不能是用户手动增加的）
  - 语法2：tail -f 文件路径
```
ssh myserver journalctl
 | grep sshd
 | grep "Disconnected from"
 | sed -E 's/.*Disconnected from (invalid |authenticating )?user (.*) [^ ]+ port [0-9]+( \[preauth\])?$/\2/'
 | sort | uniq -c
 | sort -nk1,1 | tail -n10
 | awk '{print $2}' | paste -sd,
 ```
### 正则表达式
- 常见模式
  - ``.`` 除换行符之外的”任意单个字符”
  - ``*`` 匹配前面字符零次或多次
  - ``+`` 匹配前面字符一次或多次
  - ``[abc]`` 匹配 a, b 和 c 中的任意一个
  - ``(RX1|RX2)`` 任何能够匹配RX1 或 RX2的结果
  - ``^`` 行首
  - ``$`` 行尾
- 规则
  - ``*``和``+``在默认情况下是贪婪模式，添加``?``编程非贪婪模式，但**sed不支持此后缀，需要切换到perl的命令行模式**，``perl -pe 's/.*?Disconnected from //'``
  - 匹配一整行``| sed -E 's/.*Disconnected from (invalid |authenticating )?user .* [^ ]+ port [0-9]+( \[preauth\])?$//'``，结果是把日志内容全部替换为空字符串
  - ``[^ ]+``会匹配任意非空且不包含空格的序列
  - 如果希望能够将用户名保留下来，可以使用``捕获组(capture groups)``来完成。被圆括号内的正则表达式匹配到的文本，都会被存入一系列以编号区分的捕获组中。捕获组的内容可以在替换字符串时使用(有些正则表达式的引擎甚至支持替换表达式本身)，例如``\1``、``\2``、``\3``等等，因此可以使用如下命令：`` | sed -E 's/.*Disconnected from (invalid |authenticating )?user (.*) [^ ]+ port [0-9]+( \[preauth\])?$/\2/'``
### awk
是一种编程语言
> ex.1

```
 | awk '{print $2}' | paste -sd,
 ```

``{print $2}``的作用: awk 程序接受一个模式串（可选），以及一个代码块，指定当模式匹配时应该做何种操作。默认当模式串即匹配所有行
- ``$0``表示整行的内容，``$1``到``$n``为一行中的 n 个区域
- 区域的分割基于``awk``的域分隔符(默认是空格，可以通过``-F``来修改)
- 在这个例子中，我们的代码意思是：对于每一行文本，打印其第二个部分(即用户名)
>ex.2

```
 | awk '$1 == 1 && $2 ~ /^c[^ ]*e$/ { print $2 }' | wc -l
```
- 匹配模式串（{...}前面的那部分内容），该匹配要求文本的第一部分需要等于1（这部分刚好是uniq -c得到的计数值），然后其第二部分必须满足给定的一个正则表达式
- 代码块中的内容则表示打印用户名。
- 然后使用 wc -l 统计输出结果的行数。
```
BEGIN { rows = 0 }
$1 == 1 && $2 ~ /^c[^ ]*e$/ { rows += $1 }
END { print rows }
```
- ``BEGIN``匹配输入的开头（``END``则匹配结尾）
- 对每一行第一个部分进行累加
- 最后将结果输出
## 分析数据
### R语言
适合被用来进行数据分析和绘制图表
``gnuplot``
### st
### 利用数据整理来确定参数
``xargs``
### 整理二进制数据
用``ffmpeg``从相机中捕获一张图片，将其转换成灰度图后通过SSH将压缩后的文件发送到远端服务器，并在那里解压、存档并显示
```
ffmpeg -loglevel panic -i /dev/video0 -frames 1 -f image2 -
 | convert - -colorspace gray -
 | gzip
 | ssh mymachine 'gzip -d | tee copy.jpg | env DISPLAY=:0 feh -'
```
